:- auto_table.

plus_learned(Pkt, Sw, Pt, Mac):-
locSw(Pkt, Sw),
dlSrc(Pkt, Mac),
locPt(Pkt, Pt).

minus_learned(Pkt, Sw, Pt, Mac):-
locSw(Pkt, Sw),
dlSrc(Pkt, Mac),
tnot(locPt(Pkt, Pt)).

emit(Pkt, LocSw, LocPt, DlSrc, DlDst, DlTyp, NwSrc, NwDst, NwProto):-
locSw(Pkt, LocSw),
dlSrc(Pkt, DlSrc),
dlDst(Pkt, DlDst),
dlTyp(Pkt, DlTyp),
nwSrc(Pkt, NwSrc),
nwDst(Pkt, NwDst),
nwProto(Pkt, NwProto),
learned(LocSw, LocPt, DlDst).


emit(Pkt, LocSw, LocPt, DlSrc, DlDst, DlTyp, NwSrc, NwDst, NwProto):-
locSw(Pkt, LocSw),
tnot(locPt(Pkt, LocPt)),
dlSrc(Pkt, DlSrc),
dlDst(Pkt, DlDst),
dlTyp(Pkt, DlTyp),
nwSrc(Pkt, NwSrc),
nwDst(Pkt, NwDst),
nwProto(Pkt, NwProto),
tnot(learned(LocSw, Any, DlDst)).


learned(Sw, Pt, Mac):-
plus_learned(Any, Sw, Pt, Mac),
tnot(minus_learned(Any, Sw, Pt, Mac)).

% Incoming packets

locSw(pkt1, 1).
locPt(pkt1, 2).
dlSrc(pkt1, 3).
dlDst(pkt1, 4).
dlTyp(pkt1, 5).
nwSrc(pkt1, 6).
nwDst(pkt1, 7).
nwProto(pkt1, 8).
